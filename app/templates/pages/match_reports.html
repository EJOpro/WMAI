{% extends "base.html" %}

{% block title %}🔍 커뮤니티 신고 검증 플랫폼{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/match_reports_bootstrap_replacement.css') }}">
<link rel="stylesheet" href="{{ url_for('static', path='/css/match_reports.css') }}">
{% endblock %}

{% block content %}
<div class="page-reports">
    <!-- 헤더 -->
    <div class="page-header">
        <h1>신고분류</h1>
        <p>커뮤니티 신고 검증 플랫폼</p>
    </div>

    <!-- API 키 확인 알림 -->
    <div id="apiKeyAlert" class="alert alert-danger" style="display: none;">
        ❌ config.env 파일에 API 키를 설정해주세요
    </div>

    <!-- 메인 입력 폼 -->
    <div class="row">
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5>📝 신고된 게시글</h5>
                </div>
                <div class="card-body">
                    <textarea 
                        id="postContent" 
                        class="form-control" 
                        rows="10" 
                        placeholder="신고된 게시글의 내용을 여기에 입력하세요..."
                    ></textarea>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5>🚨 신고 사유</h5>
                </div>
                <div class="card-body d-flex flex-column">
                    <div class="mb-3">
                        <label for="reportReason" class="form-label">신고 사유를 선택하세요</label>
                        <select id="reportReason" class="form-select">
                            <option value="욕설 및 비방">욕설 및 비방</option>
                            <option value="도배 및 광고">도배 및 광고</option>
                            <option value="사생활 침해">사생활 침해</option>
                            <option value="저작권 침해">저작권 침해</option>
                        </select>
                    </div>
                    
                    <div id="reasonDescription" class="alert alert-info mb-3">
                        📌 타인을 모욕하거나 명예를 훼손하는 내용
                    </div>
                    
                    <div class="mt-auto">
                        <button id="analyzeBtn" class="btn btn-primary w-100 btn-lg">
                            🔍 일치 여부 분석
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 결과 표시 영역 -->
    <div id="resultSection" class="mt-4" style="display: none;">
        <hr>
        <h3>📊 분석 결과</h3>
        <div id="resultCard" class="result-card">
            <!-- 결과가 여기에 동적으로 표시됩니다 -->
        </div>
        <div id="progressContainer" class="mt-3">
            <div class="progress" style="height: 20px;">
                <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div>
    </div>

    <!-- 예시 데이터 섹션 -->
    <hr class="my-5">
    <div class="row">
        <div class="col-12">
            <h3>💡 예시 데이터</h3>
            <div id="examplesSection" class="row">
                <!-- 예시 데이터가 여기에 동적으로 로드됩니다 -->
            </div>
        </div>
    </div>

    <!-- 관리 페이지 링크 -->
    <hr class="my-5">
    <div class="alert alert-info">
        📊 <strong>관리자이신가요?</strong> 
        <a href="/reports/admin" class="btn btn-outline-primary btn-sm ms-2">관리 페이지 접속</a>
    </div>

    <!-- 로딩 모달 -->
    <div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center py-4">
                    <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">분석 중...</span>
                    </div>
                    <h5>🤖 AI가 분석 중입니다...</h5>
                    <p class="text-muted">잠시만 기다려주세요.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', path='/js/match_bootstrap_replacement.js') }}"></script>
<script src="{{ url_for('static', path='/js/match_main.js') }}"></script>
<script>
// body에 page-reports 클래스 추가
document.body.classList.add('page-reports');
</script>
{% endblock %}